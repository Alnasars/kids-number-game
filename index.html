<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>Number Fun Kids Math</title>

    <script defer src="/_vercel/insights/script.js"></script>
    
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="Number Fun">
    <meta name="theme-color" content="#0ea5e9">
    
    <link rel="icon" type="image/png" href="icon.png">
    <link rel="apple-touch-icon" href="icon.png">
    
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@600;800&display=swap" rel="stylesheet">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/tone/14.8.49/Tone.min.js"></script>
    
    <style>
        body { font-family: 'Inter', sans-serif; background: linear-gradient(135deg, #f0f9ff 0%, #e0f2fe 100%); overscroll-behavior: none; }
        .num-card { transition: all 0.2s cubic-bezier(0.175, 0.885, 0.32, 1.275); touch-action: manipulation; }
        .num-card:active { transform: scale(0.9) rotate(-3deg); }
        @keyframes float { 0%, 100% { transform: translateY(0); } 50% { transform: translateY(-10px); } }
        .floating { animation: float 3s ease-in-out infinite; }
    </style>
</head>
<body class="fixed inset-0 flex flex-col items-center justify-center p-4 select-none overflow-hidden">

    <div id="startOverlay" class="fixed inset-0 z-50 flex items-center justify-center bg-sky-500/10 backdrop-blur-md p-6">
        <div class="bg-white rounded-3xl p-8 shadow-2xl text-center max-w-sm w-full border-4 border-white floating">
            <div class="mb-6 relative inline-block">
                <div class="text-8xl mb-4">üöÄ</div>
                <div class="absolute -top-2 -right-2 bg-red-500 text-white text-xs font-bold px-2 py-1 rounded-full">MASTER EDITION</div>
            </div>
            <h1 class="text-4xl font-extrabold text-sky-600 mb-2">READY?</h1>
            <p class="text-slate-500 mb-8 font-semibold">Master your numbers!</p>
            <button onclick="startGame()" class="w-full bg-sky-500 hover:bg-sky-600 text-white text-2xl font-extrabold py-5 rounded-2xl shadow-lg shadow-sky-200 transition-all active:scale-95">PLAY NOW</button>
            <p class="mt-6 text-[10px] text-slate-300 uppercase tracking-widest font-bold">Master Edition</p>
        </div>
    </div>

    <div id="offlineOverlay" class="fixed inset-0 z-[60] hidden flex items-center justify-center bg-white p-6 text-center">
        <div>
            <div class="text-8xl mb-6">üéØ</div>
            <h2 class="text-3xl font-bold text-slate-800 mb-4">Daily Goal Reached!</h2>
            <p class="text-slate-500 mb-8">You finished your 5 stars for today! See you tomorrow!</p>
            <button onclick="location.reload()" class="bg-sky-500 text-white px-8 py-3 rounded-xl font-bold">Play Again</button>
        </div>
    </div>

    <div class="w-full max-w-md flex flex-col h-full py-6">
        <div class="flex items-center justify-between mb-8 px-2">
            <div id="scoreLabel" class="bg-white px-6 py-3 rounded-2xl shadow-sm text-2xl font-extrabold text-amber-500 border-2 border-amber-100">‚≠ê 0</div>
            <div class="flex gap-3">
                <button id="voiceBtn" onclick="toggleVoice()" class="bg-white w-12 h-12 rounded-xl shadow-sm flex items-center justify-center text-xl border-2 border-slate-50">üó£Ô∏è</button>
                <button id="soundBtn" onclick="toggleSound()" class="bg-white w-12 h-12 rounded-xl shadow-sm flex items-center justify-center text-xl border-2 border-slate-50">üîä</button>
            </div>
        </div>

        <div class="flex-1 flex flex-col items-center justify-center space-y-12">
            <div id="displayArea" class="h-48 flex items-center justify-center text-center px-4 transition-all duration-300">
                <div class="text-4xl font-extrabold text-slate-400 opacity-50 uppercase tracking-tighter">Wait...</div>
            </div>
            
            <div id="grid" class="grid grid-cols-2 gap-4 w-full"></div>
        </div>
    </div>

    <script>
        const game = { score: 0, ans: null, soundOn: true, voiceOn: true };
        const mainSynth = new Tone.Synth({ oscillator: { type: "triangle" }, envelope: { attack: 0.05, release: 1 } }).toDestination();
        const sadSynth = new Tone.Synth({ oscillator: { type: "sine" }, envelope: { attack: 0.1, release: 0.5 } }).toDestination();

        async function startGame() {
            await Tone.start();
            document.getElementById('startOverlay').style.display = 'none';
            newQuestion();
        }

        function newQuestion() {
            game.ans = Math.floor(Math.random() * 10) + 1;
            document.getElementById('displayArea').innerHTML = `<div class="text-9xl font-black text-sky-500 drop-shadow-sm">${game.ans}</div>`;
            if(game.voiceOn) speak(game.ans);

            const options = [game.ans];
            while(options.length < 4) {
                const r = Math.floor(Math.random() * 10) + 1;
                if(!options.includes(r)) options.push(r);
            }
            options.sort(() => Math.random() - 0.5);

            const grid = document.getElementById('grid');
            grid.innerHTML = '';
            options.forEach(n => {
                const btn = document.createElement('button');
                btn.className = 'num-card h-28 bg-white rounded-3xl text-4xl font-black text-slate-700 shadow-md shadow-sky-100/50 border-b-8 border-slate-100 flex items-center justify-center hover:border-b-4 hover:translate-y-1 active:border-b-0 active:translate-y-2 transition-all';
                btn.textContent = n;
                btn.onclick = () => check(n);
                grid.appendChild(btn);
            });
        }

        function check(n) {
            if(n === game.ans) {
                game.score++;
                if(game.soundOn) mainSynth.triggerAttackRelease("C4", "8n");
                document.getElementById('displayArea').innerHTML = '<div class="text-7xl animate-bounce">üåü</div>'; 
                if(game.voiceOn) speak("Correct!");
                if (game.score === 5) { setTimeout(() => { document.getElementById('offlineOverlay').classList.remove('hidden'); }, 1000); }
            } else { 
                if(game.soundOn) sadSynth.triggerAttackRelease("G2", "2n"); 
                document.getElementById('displayArea').innerHTML = `<div class="text-6xl text-red-400 font-bold">${game.ans}</div>`; 
                if(game.voiceOn) speak(`No, it was ${game.ans}`); 
            } 
            setTimeout(() => { document.getElementById('scoreLabel').textContent = `‚≠ê ${game.score}`; newQuestion(); }, 1800);
        }

        function speak(t) { window.speechSynthesis.cancel(); const m = new SpeechSynthesisUtterance(t); m.rate = 1.1; window.speechSynthesis.speak(m); }
        function toggleSound() { game.soundOn = !game.soundOn; document.getElementById('soundBtn').textContent = game.soundOn ? "üîä" : "üîá"; }
        function toggleVoice() { game.voiceOn = !game.voiceOn; document.getElementById('voiceBtn').textContent = game.voiceOn ? "üó£Ô∏è" : "ü§ê"; }
    </script>
</body>
</html>
